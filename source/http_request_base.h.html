<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
	"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>WinMerge File Compare Report</title>
<style type="text/css">
<!--
table {margin: 0; border: 1px solid #a0a0a0; box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.15);}
td,th {word-break: break-all; font-size: 12pt;padding: 0 3px;}
tr { vertical-align: top; }
.ln {text-align: right; word-break: normal; background-color: lightgrey;}
.title {color: white; background-color: blue; vertical-align: top; padding: 4px 4px; background: linear-gradient(mediumblue, darkblue);}
.sf3b2 {color: #000000; background-color: #ffffff; }
.sf3b5 {color: #000000; background-color: #0078d7; }
.sf3b14 {color: #000000; background-color: #ffa0a0; }
.sf3b16 {color: #000000; background-color: #f1e2ad; }
.sf3b18 {color: #000000; background-color: #ffaa82; }
.sf3b19 {color: #000000; background-color: #c8816c; }
.sf6b2 {color: #ffffff; background-color: #ffffff; }
.sf6b5 {color: #ffffff; background-color: #0078d7; }
.sf6b14 {color: #ffffff; background-color: #ffa0a0; }
.sf6b16 {color: #ffffff; background-color: #f1e2ad; }
.sf6b18 {color: #ffffff; background-color: #ffaa82; }
.sf6b19 {color: #ffffff; background-color: #c8816c; }
.sf7b2 {color: #0000ff; background-color: #ffffff; font-weight: bold; }
.sf7b5 {color: #0000ff; background-color: #0078d7; font-weight: bold; }
.sf7b14 {color: #0000ff; background-color: #ffa0a0; font-weight: bold; }
.sf7b16 {color: #0000ff; background-color: #f1e2ad; font-weight: bold; }
.sf7b18 {color: #0000ff; background-color: #ffaa82; font-weight: bold; }
.sf7b19 {color: #0000ff; background-color: #c8816c; font-weight: bold; }
.sf8b2 {color: #800080; background-color: #ffffff; }
.sf8b5 {color: #800080; background-color: #0078d7; }
.sf8b14 {color: #800080; background-color: #ffa0a0; }
.sf8b16 {color: #800080; background-color: #f1e2ad; }
.sf8b18 {color: #800080; background-color: #ffaa82; }
.sf8b19 {color: #800080; background-color: #c8816c; }
.sf9b2 {color: #008000; background-color: #ffffff; }
.sf9b5 {color: #008000; background-color: #0078d7; }
.sf9b14 {color: #008000; background-color: #ffa0a0; }
.sf9b16 {color: #008000; background-color: #f1e2ad; }
.sf9b18 {color: #008000; background-color: #ffaa82; }
.sf9b19 {color: #008000; background-color: #c8816c; }
.sf10b2 {color: #ff0000; background-color: #ffffff; }
.sf10b5 {color: #ff0000; background-color: #0078d7; }
.sf10b14 {color: #ff0000; background-color: #ffa0a0; }
.sf10b16 {color: #ff0000; background-color: #f1e2ad; }
.sf10b18 {color: #ff0000; background-color: #ffaa82; }
.sf10b19 {color: #ff0000; background-color: #c8816c; }
.sf11b2 {color: #606060; background-color: #ffffff; }
.sf11b5 {color: #606060; background-color: #0078d7; }
.sf11b14 {color: #606060; background-color: #ffa0a0; }
.sf11b16 {color: #606060; background-color: #f1e2ad; }
.sf11b18 {color: #606060; background-color: #ffaa82; }
.sf11b19 {color: #606060; background-color: #c8816c; }
.sf12b2 {color: #800000; background-color: #ffffff; }
.sf12b5 {color: #800000; background-color: #0078d7; }
.sf12b14 {color: #800000; background-color: #ffa0a0; }
.sf12b16 {color: #800000; background-color: #f1e2ad; }
.sf12b18 {color: #800000; background-color: #ffaa82; }
.sf12b19 {color: #800000; background-color: #c8816c; }
.sf13b2 {color: #0080c0; background-color: #ffffff; }
.sf13b5 {color: #0080c0; background-color: #0078d7; }
.sf13b14 {color: #0080c0; background-color: #ffa0a0; }
.sf13b16 {color: #0080c0; background-color: #f1e2ad; }
.sf13b18 {color: #0080c0; background-color: #ffaa82; }
.sf13b19 {color: #0080c0; background-color: #c8816c; }
.sf15b2 {color: #000000; background-color: #ffffff; }
.sf15b5 {color: #000000; background-color: #0078d7; }
.sf15b14 {color: #000000; background-color: #ffa0a0; }
.sf15b16 {color: #000000; background-color: #f1e2ad; }
.sf15b18 {color: #000000; background-color: #ffaa82; }
.sf15b19 {color: #000000; background-color: #c8816c; }
.sf17b2 {color: #000000; background-color: #ffffff; }
.sf17b5 {color: #000000; background-color: #0078d7; }
.sf17b14 {color: #000000; background-color: #ffa0a0; }
.sf17b16 {color: #000000; background-color: #f1e2ad; }
.sf17b18 {color: #000000; background-color: #ffaa82; }
.sf17b19 {color: #000000; background-color: #c8816c; }
.sf20b2 {color: #000080; background-color: #ffffff; }
.sf20b5 {color: #000080; background-color: #0078d7; }
.sf20b14 {color: #000080; background-color: #ffa0a0; }
.sf20b16 {color: #000080; background-color: #f1e2ad; }
.sf20b18 {color: #000080; background-color: #ffaa82; }
.sf20b19 {color: #000080; background-color: #c8816c; }
.sf21b2 {color: #0080c0; background-color: #ffffff; }
.sf21b5 {color: #0080c0; background-color: #0078d7; }
.sf21b14 {color: #0080c0; background-color: #ffa0a0; }
.sf21b16 {color: #0080c0; background-color: #f1e2ad; }
.sf21b18 {color: #0080c0; background-color: #ffaa82; }
.sf21b19 {color: #0080c0; background-color: #c8816c; }
-->
</style>
</head>
<body>
<table cellspacing="0" cellpadding="0" style="width:100%;">
<thead>
<tr>
<th colspan="2" class="title" style="width:50.000000%">http_request_base.h<br>変更前</th>
<th colspan="2" class="title" style="width:50.000000%">http_request_base.h<br>変更後</th>
</tr>
</thead>
<tbody>
<tr>
<td class="ln">1</td><td class="sf3b2"><code><span class="sf9b2">/*</span></code></td>
<td class="ln">1</td><td class="sf3b2"><code><span class="sf9b2">/*</span></code></td>
</tr>
<tr>
<td class="ln">2</td><td class="sf3b2"><code><span class="sf9b2"> * PackageLicenseDeclared: Apache-2.0</span></code></td>
<td class="ln">2</td><td class="sf3b2"><code><span class="sf9b2"> * PackageLicenseDeclared: Apache-2.0</span></code></td>
</tr>
<tr>
<td class="ln">3</td><td class="sf3b2"><code><span class="sf9b2"> * Copyright (c) 2017 ARM Limited</span></code></td>
<td class="ln">3</td><td class="sf3b2"><code><span class="sf9b2"> * Copyright (c) 2017 ARM Limited</span></code></td>
</tr>
<tr>
<td class="ln">4</td><td class="sf3b2"><code><span class="sf9b2"> *</span></code></td>
<td class="ln">4</td><td class="sf3b2"><code><span class="sf9b2"> *</span></code></td>
</tr>
<tr>
<td class="ln">5</td><td class="sf3b2"><code><span class="sf9b2"> * Licensed under the Apache License, Version 2.0 (the "License");</span></code></td>
<td class="ln">5</td><td class="sf3b2"><code><span class="sf9b2"> * Licensed under the Apache License, Version 2.0 (the "License");</span></code></td>
</tr>
<tr>
<td class="ln">6</td><td class="sf3b2"><code><span class="sf9b2"> * you may not use this file except in compliance with the License.</span></code></td>
<td class="ln">6</td><td class="sf3b2"><code><span class="sf9b2"> * you may not use this file except in compliance with the License.</span></code></td>
</tr>
<tr>
<td class="ln">7</td><td class="sf3b2"><code><span class="sf9b2"> * You may obtain a copy of the License at</span></code></td>
<td class="ln">7</td><td class="sf3b2"><code><span class="sf9b2"> * You may obtain a copy of the License at</span></code></td>
</tr>
<tr>
<td class="ln">8</td><td class="sf3b2"><code><span class="sf9b2"> *</span></code></td>
<td class="ln">8</td><td class="sf3b2"><code><span class="sf9b2"> *</span></code></td>
</tr>
<tr>
<td class="ln">9</td><td class="sf3b2"><code><span class="sf9b2"> * &nbsp; &nbsp; http://www.apache.org/licenses/LICENSE-<wbr>2.0</span></code></td>
<td class="ln">9</td><td class="sf3b2"><code><span class="sf9b2"> * &nbsp; &nbsp; http://www.apache.org/licenses/LICENSE-<wbr>2.0</span></code></td>
</tr>
<tr>
<td class="ln">10</td><td class="sf3b2"><code><span class="sf9b2"> *</span></code></td>
<td class="ln">10</td><td class="sf3b2"><code><span class="sf9b2"> *</span></code></td>
</tr>
<tr>
<td class="ln">11</td><td class="sf3b2"><code><span class="sf9b2"> * Unless required by applicable law or agreed to in writing, software</span></code></td>
<td class="ln">11</td><td class="sf3b2"><code><span class="sf9b2"> * Unless required by applicable law or agreed to in writing, software</span></code></td>
</tr>
<tr>
<td class="ln">12</td><td class="sf3b2"><code><span class="sf9b2"> * distributed under the License is distributed on an "AS IS" BASIS,</span></code></td>
<td class="ln">12</td><td class="sf3b2"><code><span class="sf9b2"> * distributed under the License is distributed on an "AS IS" BASIS,</span></code></td>
</tr>
<tr>
<td class="ln">13</td><td class="sf3b2"><code><span class="sf9b2"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></code></td>
<td class="ln">13</td><td class="sf3b2"><code><span class="sf9b2"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></code></td>
</tr>
<tr>
<td class="ln">14</td><td class="sf3b2"><code><span class="sf9b2"> * See the License for the specific language governing permissions and</span></code></td>
<td class="ln">14</td><td class="sf3b2"><code><span class="sf9b2"> * See the License for the specific language governing permissions and</span></code></td>
</tr>
<tr>
<td class="ln">15</td><td class="sf3b2"><code><span class="sf9b2"> * limitations under the License.</span></code></td>
<td class="ln">15</td><td class="sf3b2"><code><span class="sf9b2"> * limitations under the License.</span></code></td>
</tr>
<tr>
<td class="ln">16</td><td class="sf3b2"><code><span class="sf9b2"> */</span>&nbsp;</code></td>
<td class="ln">16</td><td class="sf3b2"><code><span class="sf9b2"> */</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">17</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">17</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">18</td><td class="sf3b2"><code><span class="sf13b2">#ifndef _HTTP_REQUEST_BASE_H_</span></code></td>
<td class="ln">18</td><td class="sf3b2"><code><span class="sf13b2">#ifndef _HTTP_REQUEST_BASE_H_</span></code></td>
</tr>
<tr>
<td class="ln">19</td><td class="sf3b2"><code><span class="sf13b2">#define _HTTP_REQUEST_BASE_H_</span></code></td>
<td class="ln">19</td><td class="sf3b2"><code><span class="sf13b2">#define _HTTP_REQUEST_BASE_H_</span></code></td>
</tr>
<tr>
<td class="ln">20</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">20</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">21</td><td class="sf3b2"><code><span class="sf13b2">#include &lt;map&gt;</span></code></td>
<td class="ln">21</td><td class="sf3b2"><code><span class="sf13b2">#include &lt;map&gt;</span></code></td>
</tr>
<tr>
<td class="ln">22</td><td class="sf3b2"><code><span class="sf13b2">#include &lt;string&gt;</span></code></td>
<td class="ln">22</td><td class="sf3b2"><code><span class="sf13b2">#include &lt;string&gt;</span></code></td>
</tr>
<tr>
<td class="ln">23</td><td class="sf3b2"><code><span class="sf13b2">#include &lt;vector&gt;</span></code></td>
<td class="ln">23</td><td class="sf3b2"><code><span class="sf13b2">#include &lt;vector&gt;</span></code></td>
</tr>
<tr>
<td class="ln">24</td><td class="sf3b2"><code><span class="sf13b2">#include "mbed.h"</span></code></td>
<td class="ln">24</td><td class="sf3b2"><code><span class="sf13b2">#include "mbed.h"</span></code></td>
</tr>
<tr>
<td class="ln">25</td><td class="sf3b2"><code><span class="sf13b2">#include "http_parser.h"</span></code></td>
<td class="ln">25</td><td class="sf3b2"><code><span class="sf13b2">#include "http_parser.h"</span></code></td>
</tr>
<tr>
<td class="ln">26</td><td class="sf3b2"><code><span class="sf13b2">#include "http_parsed_url.h"</span></code></td>
<td class="ln">26</td><td class="sf3b2"><code><span class="sf13b2">#include "http_parsed_url.h"</span></code></td>
</tr>
<tr>
<td class="ln">27</td><td class="sf3b2"><code><span class="sf13b2">#include "http_request_builder.h"</span></code></td>
<td class="ln">27</td><td class="sf3b2"><code><span class="sf13b2">#include "http_request_builder.h"</span></code></td>
</tr>
<tr>
<td class="ln">28</td><td class="sf3b2"><code><span class="sf13b2">#include "http_request_parser.h"</span></code></td>
<td class="ln">28</td><td class="sf3b2"><code><span class="sf13b2">#include "http_request_parser.h"</span></code></td>
</tr>
<tr>
<td class="ln">29</td><td class="sf3b2"><code><span class="sf13b2">#include "http_response.h"</span></code></td>
<td class="ln">29</td><td class="sf3b2"><code><span class="sf13b2">#include "http_response.h"</span></code></td>
</tr>
<tr>
<td class="ln">30</td><td class="sf3b2"><code><span class="sf13b2">#include "NetworkInterface.h"</span></code></td>
<td class="ln">30</td><td class="sf3b2"><code><span class="sf13b2">#include "NetworkInterface.h"</span></code></td>
</tr>
<tr>
<td class="ln">31</td><td class="sf3b2"><code><span class="sf13b2">#include "netsocket/Socket.h"</span></code></td>
<td class="ln">31</td><td class="sf3b2"><code><span class="sf13b2">#include "netsocket/Socket.h"</span></code></td>
</tr>
<tr>
<td class="ln">32</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">32</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">33</td><td class="sf3b2"><code><span class="sf9b2">/**</span></code></td>
<td class="ln">33</td><td class="sf3b2"><code><span class="sf9b2">/**</span></code></td>
</tr>
<tr>
<td class="ln">34</td><td class="sf3b2"><code><span class="sf9b2"> * @todo:</span></code></td>
<td class="ln">34</td><td class="sf3b2"><code><span class="sf9b2"> * @todo:</span></code></td>
</tr>
<tr>
<td class="ln">35</td><td class="sf3b2"><code><span class="sf9b2"> * &nbsp; &nbsp; &nbsp;- Userinfo parameter is not handled</span></code></td>
<td class="ln">35</td><td class="sf3b2"><code><span class="sf9b2"> * &nbsp; &nbsp; &nbsp;- Userinfo parameter is not handled</span></code></td>
</tr>
<tr>
<td class="ln">36</td><td class="sf3b2"><code><span class="sf9b2"> */</span>&nbsp;</code></td>
<td class="ln">36</td><td class="sf3b2"><code><span class="sf9b2"> */</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">37</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">37</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">38</td><td class="sf3b2"><code><span class="sf13b2">#ifndef HTTP_RECEIVE_BUFFER_SIZE</span></code></td>
<td class="ln">38</td><td class="sf3b2"><code><span class="sf13b2">#ifndef HTTP_RECEIVE_BUFFER_SIZE</span></code></td>
</tr>
<tr>
<td class="ln">39</td><td class="sf3b2"><code><span class="sf13b2">#define HTTP_RECEIVE_BUFFER_SIZE 8 * 1024</span></code></td>
<td class="ln">39</td><td class="sf3b2"><code><span class="sf13b2">#define HTTP_RECEIVE_BUFFER_SIZE 8 * 1024</span></code></td>
</tr>
<tr>
<td class="ln">40</td><td class="sf3b2"><code><span class="sf13b2">#endif</span></code></td>
<td class="ln">40</td><td class="sf3b2"><code><span class="sf13b2">#endif</span></code></td>
</tr>
<tr>
<td class="ln">41</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">41</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">42</td><td class="sf3b2"><code><span class="sf7b2">class</span><span class="sf11b2"> </span><span class="sf3b2">HttpRequest</span><span class="sf11b2">;</span></code></td>
<td class="ln">42</td><td class="sf3b2"><code><span class="sf7b2">class</span><span class="sf11b2"> </span><span class="sf3b2">HttpRequest</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">43</td><td class="sf3b2"><code><span class="sf7b2">class</span><span class="sf11b2"> </span><span class="sf3b2">HttpsRequest</span><span class="sf11b2">;</span></code></td>
<td class="ln">43</td><td class="sf3b2"><code><span class="sf7b2">class</span><span class="sf11b2"> </span><span class="sf3b2">HttpsRequest</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">44</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">44</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">45</td><td class="sf3b2"><code><span class="sf9b2">/**</span></code></td>
<td class="ln">45</td><td class="sf3b2"><code><span class="sf9b2">/**</span></code></td>
</tr>
<tr>
<td class="ln">46</td><td class="sf3b2"><code><span class="sf9b2"> * \brief HttpRequest implements the logic for interacting with HTTP servers.</span></code></td>
<td class="ln">46</td><td class="sf3b2"><code><span class="sf9b2"> * \brief HttpRequest implements the logic for interacting with HTTP servers.</span></code></td>
</tr>
<tr>
<td class="ln">47</td><td class="sf3b2"><code><span class="sf9b2"> */</span>&nbsp;</code></td>
<td class="ln">47</td><td class="sf3b2"><code><span class="sf9b2"> */</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">48</td><td class="sf3b2"><code><span class="sf7b2">class</span><span class="sf11b2"> </span><span class="sf3b2">HttpRequestBase</span><span class="sf11b2"> {</span></code></td>
<td class="ln">48</td><td class="sf3b2"><code><span class="sf7b2">class</span><span class="sf11b2"> </span><span class="sf3b2">HttpRequestBase</span><span class="sf11b2"> {</span></code></td>
</tr>
<tr>
<td class="ln">49</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf7b2">friend</span><span class="sf11b2"> </span><span class="sf7b2">class</span><span class="sf11b2"> </span><span class="sf3b2">HttpRequest</span><span class="sf11b2">;</span></code></td>
<td class="ln">49</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf7b2">friend</span><span class="sf11b2"> </span><span class="sf7b2">class</span><span class="sf11b2"> </span><span class="sf3b2">HttpRequest</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">50</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf7b2">friend</span><span class="sf11b2"> </span><span class="sf7b2">class</span><span class="sf11b2"> </span><span class="sf3b2">HttpsRequest</span><span class="sf11b2">;</span></code></td>
<td class="ln">50</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf7b2">friend</span><span class="sf11b2"> </span><span class="sf7b2">class</span><span class="sf11b2"> </span><span class="sf3b2">HttpsRequest</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">51</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">51</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">52</td><td class="sf3b2"><code><span class="sf7b2">public</span><span class="sf11b2">:</span></code></td>
<td class="ln">52</td><td class="sf3b2"><code><span class="sf7b2">public</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln">53</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf8b2">HttpRequestBase</span><span class="sf11b2">(</span><span class="sf3b2">Socket</span><span class="sf11b2"> *</span><span class="sf3b2">socket</span><span class="sf11b2">, </span><span class="sf3b2">Callback</span><span class="sf11b2">&lt;</span><span class="sf7b2">void</span><span class="sf11b2">(</span><span class="sf7b2">const</span><span class="sf11b2"> </span><span class="sf7b2">char</span><span class="sf11b2"> *</span><span class="sf3b2">at</span><span class="sf11b2">, </span><span class="sf3b2">uint32_t</span><span class="sf11b2"> </span><span class="sf3b2">length</span><span class="sf11b2">)&gt; </span><span class="sf3b2">bodyCallback</span><span class="sf11b2">)</span></code></td>
<td class="ln">53</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf8b2">HttpRequestBase</span><span class="sf11b2">(</span><span class="sf3b2">Socket</span><span class="sf11b2"> *</span><span class="sf3b2">socket</span><span class="sf11b2">, </span><span class="sf3b2">Callback</span><span class="sf11b2">&lt;</span><span class="sf7b2">void</span><span class="sf11b2">(</span><span class="sf7b2">const</span><span class="sf11b2"> </span><span class="sf7b2">char</span><span class="sf11b2"> *</span><span class="sf3b2">at</span><span class="sf11b2">, </span><span class="sf3b2">uint32_t</span><span class="sf11b2"> </span><span class="sf3b2">length</span><span class="sf11b2">)&gt; </span><span class="sf3b2">bodyCallback</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln">54</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;: </span><span class="sf8b2">_socket</span><span class="sf11b2">(</span><span class="sf3b2">socket</span><span class="sf11b2">), </span><span class="sf8b2">_body_callback</span><span class="sf11b2">(</span><span class="sf3b2">bodyCallback</span><span class="sf11b2">), </span><span class="sf8b2">_request_buffer</span><span class="sf11b2">(</span><span class="sf3b2">NULL</span><span class="sf11b2">), </span><span class="sf8b2">_request_buffer_ix</span><span class="sf11b2">(</span><span class="sf10b2">0</span><span class="sf11b2">)</span></code></td>
<td class="ln">54</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;: </span><span class="sf8b2">_socket</span><span class="sf11b2">(</span><span class="sf3b2">socket</span><span class="sf11b2">), </span><span class="sf8b2">_body_callback</span><span class="sf11b2">(</span><span class="sf3b2">bodyCallback</span><span class="sf11b2">), </span><span class="sf8b2">_request_buffer</span><span class="sf11b2">(</span><span class="sf3b2">NULL</span><span class="sf11b2">), </span><span class="sf8b2">_request_buffer_ix</span><span class="sf11b2">(</span><span class="sf10b2">0</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln">55</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;{}</span></code></td>
<td class="ln">55</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;{}</span></code></td>
</tr>
<tr>
<td class="ln">56</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">56</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">57</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf9b2">/**</span></code></td>
<td class="ln">57</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf9b2">/**</span></code></td>
</tr>
<tr>
<td class="ln">58</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * HttpRequest Constructor</span></code></td>
<td class="ln">58</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * HttpRequest Constructor</span></code></td>
</tr>
<tr>
<td class="ln">59</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; */</span>&nbsp;</code></td>
<td class="ln">59</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; */</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">60</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf7b2">virtual</span><span class="sf11b2"> ~</span><span class="sf8b2">HttpRequestBase</span><span class="sf11b2">() {</span></code></td>
<td class="ln">60</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf7b2">virtual</span><span class="sf11b2"> ~</span><span class="sf8b2">HttpRequestBase</span><span class="sf11b2">() {</span></code></td>
</tr>
<tr>
<td class="ln">61</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// should response be owned by us? Or should user free it?</span></code></td>
<td class="ln">61</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// should response be owned by us? Or should user free it?</span></code></td>
</tr>
<tr>
<td class="ln">62</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// maybe implement copy constructor on response...</span></code></td>
<td class="ln">62</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// maybe implement copy constructor on response...</span></code></td>
</tr>
<tr>
<td class="ln">63</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">_response</span><span class="sf11b2">) {</span></code></td>
<td class="ln">63</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">_response</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">64</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">delete</span><span class="sf11b2"> </span><span class="sf3b2">_response</span><span class="sf11b2">;</span></code></td>
<td class="ln">64</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">delete</span><span class="sf11b2"> </span><span class="sf3b2">_response</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">65</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">65</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">66</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">66</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">67</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">_parsed_url</span><span class="sf11b2">) {</span></code></td>
<td class="ln">67</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">_parsed_url</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">68</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">delete</span><span class="sf11b2"> </span><span class="sf3b2">_parsed_url</span><span class="sf11b2">;</span></code></td>
<td class="ln">68</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">delete</span><span class="sf11b2"> </span><span class="sf3b2">_parsed_url</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">69</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">69</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">70</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">70</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">71</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">_request_builder</span><span class="sf11b2">) {</span></code></td>
<td class="ln">71</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">_request_builder</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">72</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">delete</span><span class="sf11b2"> </span><span class="sf3b2">_request_builder</span><span class="sf11b2">;</span></code></td>
<td class="ln">72</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">delete</span><span class="sf11b2"> </span><span class="sf3b2">_request_builder</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">73</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">73</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">74</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">74</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">75</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">_socket</span><span class="sf11b2"> &amp;&amp; </span><span class="sf3b2">_we_created_socket</span><span class="sf11b2">) {</span></code></td>
<td class="ln">75</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">_socket</span><span class="sf11b2"> &amp;&amp; </span><span class="sf3b2">_we_created_socket</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">76</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">delete</span><span class="sf11b2"> </span><span class="sf3b2">_socket</span><span class="sf11b2">;</span></code></td>
<td class="ln">76</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">delete</span><span class="sf11b2"> </span><span class="sf3b2">_socket</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">77</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">77</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">78</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
<td class="ln">78</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">79</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">79</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">80</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf9b2">/**</span></code></td>
<td class="ln">80</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf9b2">/**</span></code></td>
</tr>
<tr>
<td class="ln">81</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * Execute the request and receive the response.</span></code></td>
<td class="ln">81</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * Execute the request and receive the response.</span></code></td>
</tr>
<tr>
<td class="ln">82</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * This adds a Content-Length header to the request (when body_size is set), and sends the data to the server.</span></code></td>
<td class="ln">82</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * This adds a Content-Length header to the request (when body_size is set), and sends the data to the server.</span></code></td>
</tr>
<tr>
<td class="ln">83</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * @param body Pointer to the body to be sent</span></code></td>
<td class="ln">83</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * @param body Pointer to the body to be sent</span></code></td>
</tr>
<tr>
<td class="ln">84</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * @param body_size Size of the body to be sent</span></code></td>
<td class="ln">84</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * @param body_size Size of the body to be sent</span></code></td>
</tr>
<tr>
<td class="ln">85</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * @return An HttpResponse pointer on success, or NULL on failure.</span></code></td>
<td class="ln">85</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * @return An HttpResponse pointer on success, or NULL on failure.</span></code></td>
</tr>
<tr>
<td class="ln">86</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; &nbsp; See get_error() for the error code.</span></code></td>
<td class="ln">86</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; &nbsp; See get_error() for the error code.</span></code></td>
</tr>
<tr>
<td class="ln">87</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; */</span>&nbsp;</code></td>
<td class="ln">87</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; */</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">88</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">HttpResponse</span><span class="sf11b2">* </span><span class="sf8b2">send</span><span class="sf11b2">(</span><span class="sf7b2">const</span><span class="sf11b2"> </span><span class="sf7b2">void</span><span class="sf11b2">* </span><span class="sf3b2">body</span><span class="sf11b2"> = </span><span class="sf3b2">NULL</span><span class="sf11b2">, </span><span class="sf3b2">nsapi_size_t</span><span class="sf11b2"> </span><span class="sf3b2">body_size</span><span class="sf11b2"> = </span><span class="sf10b2">0</span><span class="sf11b2">) {</span></code></td>
<td class="ln">88</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">HttpResponse</span><span class="sf11b2">* </span><span class="sf8b2">send</span><span class="sf11b2">(</span><span class="sf7b2">const</span><span class="sf11b2"> </span><span class="sf7b2">void</span><span class="sf11b2">* </span><span class="sf3b2">body</span><span class="sf11b2"> = </span><span class="sf3b2">NULL</span><span class="sf11b2">, </span><span class="sf3b2">nsapi_size_t</span><span class="sf11b2"> </span><span class="sf3b2">body_size</span><span class="sf11b2"> = </span><span class="sf10b2">0</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">89</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nsapi_size_or_error_t</span><span class="sf11b2"> </span><span class="sf3b2">ret</span><span class="sf11b2"> = </span><span class="sf8b2">connect_socket</span><span class="sf11b2">();</span></code></td>
<td class="ln">89</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nsapi_size_or_error_t</span><span class="sf11b2"> </span><span class="sf3b2">ret</span><span class="sf11b2"> = </span><span class="sf8b2">connect_socket</span><span class="sf11b2">();</span></code></td>
</tr>
<tr>
<td class="ln">90</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">90</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">91</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">ret</span><span class="sf11b2"> != </span><span class="sf3b2">NSAPI_ERROR_OK</span><span class="sf11b2">) {</span></code></td>
<td class="ln">91</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">ret</span><span class="sf11b2"> != </span><span class="sf3b2">NSAPI_ERROR_OK</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">92</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_error</span><span class="sf11b2"> = </span><span class="sf3b2">ret</span><span class="sf11b2">;</span></code></td>
<td class="ln">92</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_error</span><span class="sf11b2"> = </span><span class="sf3b2">ret</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">93</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">NULL</span><span class="sf11b2">;</span></code></td>
<td class="ln">93</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">NULL</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">94</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">94</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">95</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">95</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">96</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_request_buffer_ix</span><span class="sf11b2"> = </span><span class="sf10b2">0</span><span class="sf11b2">;</span></code></td>
<td class="ln">96</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_request_buffer_ix</span><span class="sf11b2"> = </span><span class="sf10b2">0</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">97</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">97</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">98</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">uint32_t</span><span class="sf11b2"> </span><span class="sf3b2">request_size</span><span class="sf11b2"> = </span><span class="sf10b2">0</span><span class="sf11b2">;</span></code></td>
<td class="ln">98</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">uint32_t</span><span class="sf11b2"> </span><span class="sf3b2">request_size</span><span class="sf11b2"> = </span><span class="sf10b2">0</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">99</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">char</span><span class="sf11b2">* </span><span class="sf3b2">request</span><span class="sf11b2"> = </span><span class="sf3b2">_request_builder</span><span class="sf11b2">-&gt;</span><span class="sf8b2">build</span><span class="sf11b2">(</span><span class="sf3b2">body</span><span class="sf11b2">, </span><span class="sf3b2">body_size</span><span class="sf11b2">, </span><span class="sf3b2">request_size</span><span class="sf11b2">);</span></code></td>
<td class="ln">99</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">char</span><span class="sf11b2">* </span><span class="sf3b2">request</span><span class="sf11b2"> = </span><span class="sf3b2">_request_builder</span><span class="sf11b2">-&gt;</span><span class="sf8b2">build</span><span class="sf11b2">(</span><span class="sf3b2">body</span><span class="sf11b2">, </span><span class="sf3b2">body_size</span><span class="sf11b2">, </span><span class="sf3b2">request_size</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">100</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">100</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">101</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">ret</span><span class="sf11b2"> = </span><span class="sf8b2">send_buffer</span><span class="sf11b2">(</span><span class="sf3b2">request</span><span class="sf11b2">, </span><span class="sf3b2">request_size</span><span class="sf11b2">);</span></code></td>
<td class="ln">101</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">ret</span><span class="sf11b2"> = </span><span class="sf8b2">send_buffer</span><span class="sf11b2">(</span><span class="sf3b2">request</span><span class="sf11b2">, </span><span class="sf3b2">request_size</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">102</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">102</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">103</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf8b2">free</span><span class="sf11b2">(</span><span class="sf3b2">request</span><span class="sf11b2">);</span></code></td>
<td class="ln">103</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf8b2">free</span><span class="sf11b2">(</span><span class="sf3b2">request</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">104</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">104</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">105</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">ret</span><span class="sf11b2"> &lt; </span><span class="sf10b2">0</span><span class="sf11b2">) {</span></code></td>
<td class="ln">105</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">ret</span><span class="sf11b2"> &lt; </span><span class="sf10b2">0</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">106</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_error</span><span class="sf11b2"> = </span><span class="sf3b2">ret</span><span class="sf11b2">;</span></code></td>
<td class="ln">106</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_error</span><span class="sf11b2"> = </span><span class="sf3b2">ret</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">107</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">NULL</span><span class="sf11b2">;</span></code></td>
<td class="ln">107</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">NULL</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">108</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">108</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">109</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">109</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">110</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf8b2">create_http_response</span><span class="sf11b2">();</span></code></td>
<td class="ln">110</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf8b2">create_http_response</span><span class="sf11b2">();</span></code></td>
</tr>
<tr>
<td class="ln">111</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
<td class="ln">111</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">112</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">112</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">113</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf9b2">/**</span></code></td>
<td class="ln">113</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf9b2">/**</span></code></td>
</tr>
<tr>
<td class="ln">114</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * Execute the request and receive the response.</span></code></td>
<td class="ln">114</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * Execute the request and receive the response.</span></code></td>
</tr>
<tr>
<td class="ln">115</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * This sends the request through chunked-encoding.</span></code></td>
<td class="ln">115</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * This sends the request through chunked-encoding.</span></code></td>
</tr>
<tr>
<td class="ln">116</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * @param body_cb Callback which generates the next chunk of the request</span></code></td>
<td class="ln">116</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * @param body_cb Callback which generates the next chunk of the request</span></code></td>
</tr>
<tr>
<td class="ln">117</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * @return An HttpResponse pointer on success, or NULL on failure.</span></code></td>
<td class="ln">117</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * @return An HttpResponse pointer on success, or NULL on failure.</span></code></td>
</tr>
<tr>
<td class="ln">118</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; &nbsp; See get_error() for the error code.</span></code></td>
<td class="ln">118</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; &nbsp; See get_error() for the error code.</span></code></td>
</tr>
<tr>
<td class="ln">119</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; */</span>&nbsp;</code></td>
<td class="ln">119</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; */</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"><a name="d1" href="#d1">120</a></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; ">HttpResponse</span><span style="color: #000000; background-color: #efcb05; ">* </span><span style="color: #000000; background-color: #efcb05; ">send</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">Callback</span><span style="color: #000000; background-color: #efcb05; ">&lt;</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">const</span><span style="color: #000000; background-color: #efcb05; "> </span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">void</span><span style="color: #000000; background-color: #efcb05; ">*(</span><span style="color: #000000; background-color: #efcb05; ">uint32_t</span><span style="color: #000000; background-color: #efcb05; ">*)&gt; </span><span style="color: #000000; background-color: #efcb05; ">body_cb</span><span style="color: #000000; background-color: #efcb05; ">) {</span></code></td>
<td class="ln">120</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; ">HttpResponse</span><span style="color: #000000; background-color: #efcb05; ">* </span><span style="color: #000000; background-color: #efcb05; ">send</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">Callback</span><span style="color: #000000; background-color: #efcb05; ">&lt;</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">const</span><span style="color: #000000; background-color: #efcb05; "> </span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">void</span><span style="color: #000000; background-color: #efcb05; ">*(</span><span style="color: #000000; background-color: #efcb05; ">uint32_t</span><span style="color: #000000; background-color: #efcb05; ">*)&gt; </span><span style="color: #000000; background-color: #efcb05; ">body_cb</span><span class="sf17b18">,bool chunked = true</span><span style="color: #000000; background-color: #efcb05; ">) {</span></code></td>
</tr>
<tr>
<td class="ln">121</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">121</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">122</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nsapi_error_t</span><span class="sf11b2"> </span><span class="sf3b2">ret</span><span class="sf11b2">;</span></code></td>
<td class="ln">122</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nsapi_error_t</span><span class="sf11b2"> </span><span class="sf3b2">ret</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">123</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">123</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">124</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> ((</span><span class="sf3b2">ret</span><span class="sf11b2"> = </span><span class="sf8b2">connect_socket</span><span class="sf11b2">()) != </span><span class="sf3b2">NSAPI_ERROR_OK</span><span class="sf11b2">) {</span></code></td>
<td class="ln">124</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> ((</span><span class="sf3b2">ret</span><span class="sf11b2"> = </span><span class="sf8b2">connect_socket</span><span class="sf11b2">()) != </span><span class="sf3b2">NSAPI_ERROR_OK</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">125</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_error</span><span class="sf11b2"> = </span><span class="sf3b2">ret</span><span class="sf11b2">;</span></code></td>
<td class="ln">125</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_error</span><span class="sf11b2"> = </span><span class="sf3b2">ret</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">126</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">NULL</span><span class="sf11b2">;</span></code></td>
<td class="ln">126</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">NULL</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">127</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">127</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">128</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">128</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">129</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_request_buffer_ix</span><span class="sf11b2"> = </span><span class="sf10b2">0</span><span class="sf11b2">;</span></code></td>
<td class="ln">129</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_request_buffer_ix</span><span class="sf11b2"> = </span><span class="sf10b2">0</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">130</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">130</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"><a name="d2" href="#d2">131</a></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; ">set_header</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">"Transfer-Encoding"</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; ">"chunked"</span><span style="color: #000000; background-color: #efcb05; ">);</span>&nbsp;</code></td>
<td class="ln">131</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf17b18">if(chunked){</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln">132</td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; ">set_header</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">"Transfer-Encoding"</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; ">"chunked"</span><span style="color: #000000; background-color: #efcb05; ">);</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln">133</td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18"> &nbsp; &nbsp; &nbsp; &nbsp;}</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">132</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">134</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">133</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">uint32_t</span><span class="sf11b2"> </span><span class="sf3b2">request_size</span><span class="sf11b2"> = </span><span class="sf10b2">0</span><span class="sf11b2">;</span></code></td>
<td class="ln">135</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">uint32_t</span><span class="sf11b2"> </span><span class="sf3b2">request_size</span><span class="sf11b2"> = </span><span class="sf10b2">0</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">134</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">char</span><span class="sf11b2">* </span><span class="sf3b2">request</span><span class="sf11b2"> = </span><span class="sf3b2">_request_builder</span><span class="sf11b2">-&gt;</span><span class="sf8b2">build</span><span class="sf11b2">(</span><span class="sf3b2">NULL</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf3b2">request_size</span><span class="sf11b2">);</span></code></td>
<td class="ln">136</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">char</span><span class="sf11b2">* </span><span class="sf3b2">request</span><span class="sf11b2"> = </span><span class="sf3b2">_request_builder</span><span class="sf11b2">-&gt;</span><span class="sf8b2">build</span><span class="sf11b2">(</span><span class="sf3b2">NULL</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf3b2">request_size</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">135</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">137</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">136</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// first... send this request headers without the body</span></code></td>
<td class="ln">138</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// first... send this request headers without the body</span></code></td>
</tr>
<tr>
<td class="ln">137</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nsapi_size_or_error_t</span><span class="sf11b2"> </span><span class="sf3b2">total_send_count</span><span class="sf11b2"> = </span><span class="sf8b2">send_buffer</span><span class="sf11b2">(</span><span class="sf3b2">request</span><span class="sf11b2">, </span><span class="sf3b2">request_size</span><span class="sf11b2">);</span></code></td>
<td class="ln">139</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nsapi_size_or_error_t</span><span class="sf11b2"> </span><span class="sf3b2">total_send_count</span><span class="sf11b2"> = </span><span class="sf8b2">send_buffer</span><span class="sf11b2">(</span><span class="sf3b2">request</span><span class="sf11b2">, </span><span class="sf3b2">request_size</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">138</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">140</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">139</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">total_send_count</span><span class="sf11b2"> &lt; </span><span class="sf10b2">0</span><span class="sf11b2">) {</span></code></td>
<td class="ln">141</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">total_send_count</span><span class="sf11b2"> &lt; </span><span class="sf10b2">0</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">140</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf8b2">free</span><span class="sf11b2">(</span><span class="sf3b2">request</span><span class="sf11b2">);</span></code></td>
<td class="ln">142</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf8b2">free</span><span class="sf11b2">(</span><span class="sf3b2">request</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">141</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_error</span><span class="sf11b2"> = </span><span class="sf3b2">total_send_count</span><span class="sf11b2">;</span></code></td>
<td class="ln">143</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_error</span><span class="sf11b2"> = </span><span class="sf3b2">total_send_count</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">142</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">NULL</span><span class="sf11b2">;</span></code></td>
<td class="ln">144</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">NULL</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">143</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">145</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">144</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">146</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">145</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// ok... now it's time to start sending chunks...</span></code></td>
<td class="ln">147</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// ok... now it's time to start sending chunks...</span></code></td>
</tr>
<tr>
<td class="ln">146</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">while</span><span class="sf11b2"> (</span><span class="sf10b2">1</span><span class="sf11b2">) {</span></code></td>
<td class="ln">148</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">while</span><span class="sf11b2"> (</span><span class="sf10b2">1</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">147</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">uint32_t</span><span class="sf11b2"> </span><span class="sf3b2">size</span><span class="sf11b2">;</span></code></td>
<td class="ln">149</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">uint32_t</span><span class="sf11b2"> </span><span class="sf3b2">size</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">148</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">const</span><span class="sf11b2"> </span><span class="sf7b2">void</span><span class="sf11b2"> *</span><span class="sf3b2">buffer</span><span class="sf11b2"> = </span><span class="sf8b2">body_cb</span><span class="sf11b2">(&amp;</span><span class="sf3b2">size</span><span class="sf11b2">);</span></code></td>
<td class="ln">150</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">const</span><span class="sf11b2"> </span><span class="sf7b2">void</span><span class="sf11b2"> *</span><span class="sf3b2">buffer</span><span class="sf11b2"> = </span><span class="sf8b2">body_cb</span><span class="sf11b2">(&amp;</span><span class="sf3b2">size</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">149</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">151</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">150</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">size</span><span class="sf11b2"> == </span><span class="sf10b2">0</span><span class="sf11b2">) </span><span class="sf7b2">break</span><span class="sf11b2">;</span></code></td>
<td class="ln">152</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">size</span><span class="sf11b2"> == </span><span class="sf10b2">0</span><span class="sf11b2">) </span><span class="sf7b2">break</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">151</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">153</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"><a name="d3" href="#d3">152</a></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; ">// so... size in HEX, \r\n, data, \r\n again</span></code></td>
<td class="ln">154</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf17b18">if(chunked){</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">153</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">char</span><span style="color: #000000; background-color: #efcb05; "> </span><span style="color: #000000; background-color: #efcb05; ">size_buff</span><span style="color: #000000; background-color: #efcb05; ">[</span><span style="color: #000000; background-color: #efcb05; ">10</span><span style="color: #000000; background-color: #efcb05; ">]; </span><span style="color: #000000; background-color: #efcb05; ">// if sending length of more than 8 digits, you have another problem on a microcontroller...</span></code></td>
<td class="ln">155</td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; ">// so... size in HEX, \r\n, data, \r\n again</span></code></td>
</tr>
<tr>
<td class="ln">154</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">int</span><span style="color: #000000; background-color: #efcb05; "> </span><span style="color: #000000; background-color: #efcb05; ">size_buff_size</span><span style="color: #000000; background-color: #efcb05; "> = </span><span style="color: #000000; background-color: #efcb05; ">sprintf</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">size_buff</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; ">"%X\r\n"</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">static_cast</span><span style="color: #000000; background-color: #efcb05; ">&lt;</span><span style="color: #000000; background-color: #efcb05; ">size_t</span><span style="color: #000000; background-color: #efcb05; ">&gt;(</span><span style="color: #000000; background-color: #efcb05; ">size</span><span style="color: #000000; background-color: #efcb05; ">));</span></code></td>
<td class="ln">156</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf17b18"> &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">char</span><span style="color: #000000; background-color: #efcb05; "> </span><span style="color: #000000; background-color: #efcb05; ">size_buff</span><span style="color: #000000; background-color: #efcb05; ">[</span><span style="color: #000000; background-color: #efcb05; ">10</span><span style="color: #000000; background-color: #efcb05; ">]; </span><span style="color: #000000; background-color: #efcb05; ">// if sending length of more than 8 digits, you have another problem on a microcontroller...</span></code></td>
</tr>
<tr>
<td class="ln">155</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">if</span><span style="color: #000000; background-color: #efcb05; "> ((</span><span style="color: #000000; background-color: #efcb05; ">total_send_count</span><span style="color: #000000; background-color: #efcb05; "> = </span><span style="color: #000000; background-color: #efcb05; ">send_buffer</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">size_buff</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">static_cast</span><span style="color: #000000; background-color: #efcb05; ">&lt;</span><span style="color: #000000; background-color: #efcb05; ">uint32_t</span><span style="color: #000000; background-color: #efcb05; ">&gt;(</span><span style="color: #000000; background-color: #efcb05; ">size_buff_size</span><span style="color: #000000; background-color: #efcb05; ">)))<wbr> &lt; </span><span style="color: #000000; background-color: #efcb05; ">0</span><span style="color: #000000; background-color: #efcb05; ">) {</span></code></td>
<td class="ln">157</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf17b18"> &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">int</span><span style="color: #000000; background-color: #efcb05; "> </span><span style="color: #000000; background-color: #efcb05; ">size_buff_size</span><span style="color: #000000; background-color: #efcb05; "> = </span><span style="color: #000000; background-color: #efcb05; ">sprintf</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">size_buff</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; ">"%X\r\n"</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">static_cast</span><span style="color: #000000; background-color: #efcb05; ">&lt;</span><span style="color: #000000; background-color: #efcb05; ">size_t</span><span style="color: #000000; background-color: #efcb05; ">&gt;(</span><span style="color: #000000; background-color: #efcb05; ">size</span><span style="color: #000000; background-color: #efcb05; ">));</span></code></td>
</tr>
<tr>
<td class="ln">156</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; ">free</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">request</span><span style="color: #000000; background-color: #efcb05; ">);</span></code></td>
<td class="ln">158</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf17b18"> &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">if</span><span style="color: #000000; background-color: #efcb05; "> ((</span><span style="color: #000000; background-color: #efcb05; ">total_send_count</span><span style="color: #000000; background-color: #efcb05; "> = </span><span style="color: #000000; background-color: #efcb05; ">send_buffer</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">size_buff</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">static_cast</span><span style="color: #000000; background-color: #efcb05; ">&lt;</span><span style="color: #000000; background-color: #efcb05; ">uint32_t</span><span style="color: #000000; background-color: #efcb05; ">&gt;(</span><span style="color: #000000; background-color: #efcb05; ">size_buff_size</span><span style="color: #000000; background-color: #efcb05; ">)))<wbr> &lt; </span><span style="color: #000000; background-color: #efcb05; ">0</span><span style="color: #000000; background-color: #efcb05; ">) {</span></code></td>
</tr>
<tr>
<td class="ln">157</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; ">_error</span><span style="color: #000000; background-color: #efcb05; "> = </span><span style="color: #000000; background-color: #efcb05; ">total_send_count</span><span style="color: #000000; background-color: #efcb05; ">;</span></code></td>
<td class="ln">159</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf17b18"> &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; ">free</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">request</span><span style="color: #000000; background-color: #efcb05; ">);</span></code></td>
</tr>
<tr>
<td class="ln">158</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">return</span><span style="color: #000000; background-color: #efcb05; "> </span><span style="color: #000000; background-color: #efcb05; ">NULL</span><span style="color: #000000; background-color: #efcb05; ">;</span>&nbsp;</code></td>
<td class="ln">160</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf17b18"> &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; ">_error</span><span style="color: #000000; background-color: #efcb05; "> = </span><span style="color: #000000; background-color: #efcb05; ">total_send_count</span><span style="color: #000000; background-color: #efcb05; ">;</span></code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln">161</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf17b18"> &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">return</span><span style="color: #000000; background-color: #efcb05; "> </span><span style="color: #000000; background-color: #efcb05; ">NULL</span><span style="color: #000000; background-color: #efcb05; ">;</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln">162</td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">159</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">163</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">160</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">164</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">161</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// now send the normal buffer... and then \r\n at the end</span></code></td>
<td class="ln">165</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// now send the normal buffer... and then \r\n at the end</span></code></td>
</tr>
<tr>
<td class="ln">162</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">total_send_count</span><span class="sf11b2"> = </span><span class="sf8b2">send_buffer</span><span class="sf11b2">((</span><span class="sf7b2">char</span><span class="sf11b2">*)</span><span class="sf3b2">buffer</span><span class="sf11b2">, </span><span class="sf3b2">size</span><span class="sf11b2">);</span></code></td>
<td class="ln">166</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">total_send_count</span><span class="sf11b2"> = </span><span class="sf8b2">send_buffer</span><span class="sf11b2">((</span><span class="sf7b2">char</span><span class="sf11b2">*)</span><span class="sf3b2">buffer</span><span class="sf11b2">, </span><span class="sf3b2">size</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">163</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">total_send_count</span><span class="sf11b2"> &lt; </span><span class="sf10b2">0</span><span class="sf11b2">) {</span></code></td>
<td class="ln">167</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">total_send_count</span><span class="sf11b2"> &lt; </span><span class="sf10b2">0</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">164</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf8b2">free</span><span class="sf11b2">(</span><span class="sf3b2">request</span><span class="sf11b2">);</span></code></td>
<td class="ln">168</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf8b2">free</span><span class="sf11b2">(</span><span class="sf3b2">request</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">165</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_error</span><span class="sf11b2"> = </span><span class="sf3b2">total_send_count</span><span class="sf11b2">;</span></code></td>
<td class="ln">169</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_error</span><span class="sf11b2"> = </span><span class="sf3b2">total_send_count</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">166</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">NULL</span><span class="sf11b2">;</span></code></td>
<td class="ln">170</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">NULL</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">167</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">171</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">168</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">172</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"><a name="d4" href="#d4">169</a></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; ">// and... \r\n</span></code></td>
<td class="ln">173</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf17b18">if(chunked){</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">170</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">const</span><span style="color: #000000; background-color: #efcb05; "> </span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">char</span><span style="color: #000000; background-color: #efcb05; ">* </span><span style="color: #000000; background-color: #efcb05; ">rn</span><span style="color: #000000; background-color: #efcb05; "> = </span><span style="color: #000000; background-color: #efcb05; ">"\r\n"</span><span style="color: #000000; background-color: #efcb05; ">;</span></code></td>
<td class="ln">174</td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; ">// and... \r\n</span></code></td>
</tr>
<tr>
<td class="ln">171</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">if</span><span style="color: #000000; background-color: #efcb05; "> ((</span><span style="color: #000000; background-color: #efcb05; ">total_send_count</span><span style="color: #000000; background-color: #efcb05; "> = </span><span style="color: #000000; background-color: #efcb05; ">send_buffer</span><span style="color: #000000; background-color: #efcb05; ">((</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">char</span><span style="color: #000000; background-color: #efcb05; ">*)</span><span style="color: #000000; background-color: #efcb05; ">rn</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; ">2</span><span style="color: #000000; background-color: #efcb05; ">)) &lt; </span><span style="color: #000000; background-color: #efcb05; ">0</span><span style="color: #000000; background-color: #efcb05; ">) {</span>&nbsp;</code></td>
<td class="ln">175</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf17b18"> &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">const</span><span style="color: #000000; background-color: #efcb05; "> </span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">char</span><span style="color: #000000; background-color: #efcb05; ">* </span><span style="color: #000000; background-color: #efcb05; ">rn</span><span style="color: #000000; background-color: #efcb05; "> = </span><span style="color: #000000; background-color: #efcb05; ">"\r\n"</span><span style="color: #000000; background-color: #efcb05; ">;</span></code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln">176</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf17b18"> &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">if</span><span style="color: #000000; background-color: #efcb05; "> ((</span><span style="color: #000000; background-color: #efcb05; ">total_send_count</span><span style="color: #000000; background-color: #efcb05; "> = </span><span style="color: #000000; background-color: #efcb05; ">send_buffer</span><span style="color: #000000; background-color: #efcb05; ">((</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">char</span><span style="color: #000000; background-color: #efcb05; ">*)</span><span style="color: #000000; background-color: #efcb05; ">rn</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; ">2</span><span style="color: #000000; background-color: #efcb05; ">)) &lt; </span><span style="color: #000000; background-color: #efcb05; ">0</span><span style="color: #000000; background-color: #efcb05; ">) {</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln">177</td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;free(request);</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln">178</td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;_error = total_send_count;</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln">179</td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return NULL;</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln">180</td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln">181</td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln">182</td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18"> &nbsp; &nbsp; &nbsp; &nbsp;}</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln">183</td><td style="color: #000000; background-color: #efcb05; "><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln">184</td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18"> &nbsp; &nbsp; &nbsp; &nbsp;if(chunked){</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln">185</td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// finalize...?</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln">186</td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const char* fin = "0\r\n\r\n";</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln">187</td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if ((total_send_count = send_buffer((char*)fin, strlen(fin))) &lt; 0) {</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">172</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf8b2">free</span><span class="sf11b2">(</span><span class="sf3b2">request</span><span class="sf11b2">);</span></code></td>
<td class="ln">188</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf8b2">free</span><span class="sf11b2">(</span><span class="sf3b2">request</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">173</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_error</span><span class="sf11b2"> = </span><span class="sf3b2">total_send_count</span><span class="sf11b2">;</span></code></td>
<td class="ln">189</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_error</span><span class="sf11b2"> = </span><span class="sf3b2">total_send_count</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">174</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">NULL</span><span class="sf11b2">;</span></code></td>
<td class="ln">190</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">NULL</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">175</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">191</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln"><a name="d5" href="#d5">176</a></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">177</td><td style="color: #000000; background-color: #efcb05; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">178</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; ">// finalize...?</span></code></td>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">179</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">const</span><span style="color: #000000; background-color: #efcb05; "> </span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">char</span><span style="color: #000000; background-color: #efcb05; ">* </span><span style="color: #000000; background-color: #efcb05; ">fin</span><span style="color: #000000; background-color: #efcb05; "> = </span><span style="color: #000000; background-color: #efcb05; ">"0\r\n\r\n"</span><span style="color: #000000; background-color: #efcb05; ">;</span></code></td>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">180</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">if</span><span style="color: #000000; background-color: #efcb05; "> ((</span><span style="color: #000000; background-color: #efcb05; ">total_send_count</span><span style="color: #000000; background-color: #efcb05; "> = </span><span style="color: #000000; background-color: #efcb05; ">send_buffer</span><span style="color: #000000; background-color: #efcb05; ">((</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">char</span><span style="color: #000000; background-color: #efcb05; ">*)</span><span style="color: #000000; background-color: #efcb05; ">fin</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; ">strlen</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">fin</span><span style="color: #000000; background-color: #efcb05; ">))) &lt; </span><span style="color: #000000; background-color: #efcb05; ">0</span><span style="color: #000000; background-color: #efcb05; ">) {</span></code></td>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">181</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; ">free</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">request</span><span style="color: #000000; background-color: #efcb05; ">);</span></code></td>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">182</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; ">_error</span><span style="color: #000000; background-color: #efcb05; "> = </span><span style="color: #000000; background-color: #efcb05; ">total_send_count</span><span style="color: #000000; background-color: #efcb05; ">;</span></code></td>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">183</td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; "> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">return</span><span style="color: #000000; background-color: #efcb05; "> </span><span style="color: #000000; background-color: #efcb05; ">NULL</span><span style="color: #000000; background-color: #efcb05; ">;</span></code></td>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">184</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">192</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">185</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">193</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">186</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf8b2">free</span><span class="sf11b2">(</span><span class="sf3b2">request</span><span class="sf11b2">);</span></code></td>
<td class="ln">194</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf8b2">free</span><span class="sf11b2">(</span><span class="sf3b2">request</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">187</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">195</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">188</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf8b2">create_http_response</span><span class="sf11b2">();</span></code></td>
<td class="ln">196</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf8b2">create_http_response</span><span class="sf11b2">();</span></code></td>
</tr>
<tr>
<td class="ln">189</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
<td class="ln">197</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">190</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">198</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">191</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf9b2">/**</span></code></td>
<td class="ln">199</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf9b2">/**</span></code></td>
</tr>
<tr>
<td class="ln">192</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * Set a header for the request.</span></code></td>
<td class="ln">200</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * Set a header for the request.</span></code></td>
</tr>
<tr>
<td class="ln">193</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; *</span></code></td>
<td class="ln">201</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; *</span></code></td>
</tr>
<tr>
<td class="ln">194</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * The 'Host', 'Content-Length', and (optionally) 'Transfer-Encoding: chunked'</span></code></td>
<td class="ln">202</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * The 'Host', 'Content-Length', and (optionally) 'Transfer-Encoding: chunked'</span></code></td>
</tr>
<tr>
<td class="ln">195</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * headers are set automatically.</span></code></td>
<td class="ln">203</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * headers are set automatically.</span></code></td>
</tr>
<tr>
<td class="ln">196</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * Setting the same header twice will overwrite the previous entry.</span></code></td>
<td class="ln">204</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * Setting the same header twice will overwrite the previous entry.</span></code></td>
</tr>
<tr>
<td class="ln">197</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; *</span></code></td>
<td class="ln">205</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; *</span></code></td>
</tr>
<tr>
<td class="ln">198</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * @param key Header key</span></code></td>
<td class="ln">206</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * @param key Header key</span></code></td>
</tr>
<tr>
<td class="ln">199</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * @param value Header value</span></code></td>
<td class="ln">207</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * @param value Header value</span></code></td>
</tr>
<tr>
<td class="ln">200</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; */</span>&nbsp;</code></td>
<td class="ln">208</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; */</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">201</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf7b2">void</span><span class="sf11b2"> </span><span class="sf8b2">set_header</span><span class="sf11b2">(</span><span class="sf3b2">string</span><span class="sf11b2"> </span><span class="sf3b2">key</span><span class="sf11b2">, </span><span class="sf3b2">string</span><span class="sf11b2"> </span><span class="sf3b2">value</span><span class="sf11b2">) {</span></code></td>
<td class="ln">209</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf7b2">void</span><span class="sf11b2"> </span><span class="sf8b2">set_header</span><span class="sf11b2">(</span><span class="sf3b2">string</span><span class="sf11b2"> </span><span class="sf3b2">key</span><span class="sf11b2">, </span><span class="sf3b2">string</span><span class="sf11b2"> </span><span class="sf3b2">value</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">202</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_request_builder</span><span class="sf11b2">-&gt;</span><span class="sf8b2">set_header</span><span class="sf11b2">(</span><span class="sf3b2">key</span><span class="sf11b2">, </span><span class="sf3b2">value</span><span class="sf11b2">);</span></code></td>
<td class="ln">210</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_request_builder</span><span class="sf11b2">-&gt;</span><span class="sf8b2">set_header</span><span class="sf11b2">(</span><span class="sf3b2">key</span><span class="sf11b2">, </span><span class="sf3b2">value</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">203</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
<td class="ln">211</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">204</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">212</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">205</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf9b2">/**</span></code></td>
<td class="ln">213</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf9b2">/**</span></code></td>
</tr>
<tr>
<td class="ln">206</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * Get the error code.</span></code></td>
<td class="ln">214</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * Get the error code.</span></code></td>
</tr>
<tr>
<td class="ln">207</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; *</span></code></td>
<td class="ln">215</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; *</span></code></td>
</tr>
<tr>
<td class="ln">208</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * When send() fails, this error is set.</span></code></td>
<td class="ln">216</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * When send() fails, this error is set.</span></code></td>
</tr>
<tr>
<td class="ln">209</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; */</span>&nbsp;</code></td>
<td class="ln">217</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; */</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">210</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">nsapi_error_t</span><span class="sf11b2"> </span><span class="sf8b2">get_error</span><span class="sf11b2">() {</span></code></td>
<td class="ln">218</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">nsapi_error_t</span><span class="sf11b2"> </span><span class="sf8b2">get_error</span><span class="sf11b2">() {</span></code></td>
</tr>
<tr>
<td class="ln">211</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">_error</span><span class="sf11b2">;</span></code></td>
<td class="ln">219</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">_error</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">212</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
<td class="ln">220</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">213</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">221</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">214</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf9b2">/**</span></code></td>
<td class="ln">222</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf9b2">/**</span></code></td>
</tr>
<tr>
<td class="ln">215</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * Set the request log buffer, all bytes that are sent for this request are logged here.</span></code></td>
<td class="ln">223</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * Set the request log buffer, all bytes that are sent for this request are logged here.</span></code></td>
</tr>
<tr>
<td class="ln">216</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * If the buffer would overflow logging is stopped.</span></code></td>
<td class="ln">224</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * If the buffer would overflow logging is stopped.</span></code></td>
</tr>
<tr>
<td class="ln">217</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; *</span></code></td>
<td class="ln">225</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; *</span></code></td>
</tr>
<tr>
<td class="ln">218</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * @param buffer Pointer to a buffer to store the data in</span></code></td>
<td class="ln">226</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * @param buffer Pointer to a buffer to store the data in</span></code></td>
</tr>
<tr>
<td class="ln">219</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * @param buffer_size Size of the buffer</span></code></td>
<td class="ln">227</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * @param buffer_size Size of the buffer</span></code></td>
</tr>
<tr>
<td class="ln">220</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; */</span>&nbsp;</code></td>
<td class="ln">228</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; */</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">221</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf7b2">void</span><span class="sf11b2"> </span><span class="sf8b2">set_request_log_buffer</span><span class="sf11b2">(</span><span class="sf3b2">uint8_t</span><span class="sf11b2"> *</span><span class="sf3b2">buffer</span><span class="sf11b2">, </span><span class="sf3b2">size_t</span><span class="sf11b2"> </span><span class="sf3b2">buffer_size</span><span class="sf11b2">) {</span></code></td>
<td class="ln">229</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf7b2">void</span><span class="sf11b2"> </span><span class="sf8b2">set_request_log_buffer</span><span class="sf11b2">(</span><span class="sf3b2">uint8_t</span><span class="sf11b2"> *</span><span class="sf3b2">buffer</span><span class="sf11b2">, </span><span class="sf3b2">size_t</span><span class="sf11b2"> </span><span class="sf3b2">buffer_size</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">222</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_request_buffer</span><span class="sf11b2"> = </span><span class="sf3b2">buffer</span><span class="sf11b2">;</span></code></td>
<td class="ln">230</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_request_buffer</span><span class="sf11b2"> = </span><span class="sf3b2">buffer</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">223</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_request_buffer_size</span><span class="sf11b2"> = </span><span class="sf3b2">buffer_size</span><span class="sf11b2">;</span></code></td>
<td class="ln">231</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_request_buffer_size</span><span class="sf11b2"> = </span><span class="sf3b2">buffer_size</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">224</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_request_buffer_ix</span><span class="sf11b2"> = </span><span class="sf10b2">0</span><span class="sf11b2">;</span></code></td>
<td class="ln">232</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_request_buffer_ix</span><span class="sf11b2"> = </span><span class="sf10b2">0</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">225</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
<td class="ln">233</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">226</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">234</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">227</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf9b2">/**</span></code></td>
<td class="ln">235</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf9b2">/**</span></code></td>
</tr>
<tr>
<td class="ln">228</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * Get the number of bytes written to the request log buffer, since the last request.</span></code></td>
<td class="ln">236</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * Get the number of bytes written to the request log buffer, since the last request.</span></code></td>
</tr>
<tr>
<td class="ln">229</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * If no request was sent, or if the request log buffer is NULL, then this returns 0.</span></code></td>
<td class="ln">237</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; * If no request was sent, or if the request log buffer is NULL, then this returns 0.</span></code></td>
</tr>
<tr>
<td class="ln">230</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; */</span>&nbsp;</code></td>
<td class="ln">238</td><td class="sf3b2"><code><span class="sf9b2"> &nbsp; &nbsp; */</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">231</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">size_t</span><span class="sf11b2"> </span><span class="sf8b2">get_request_log_buffer_length</span><span class="sf11b2">() {</span></code></td>
<td class="ln">239</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">size_t</span><span class="sf11b2"> </span><span class="sf8b2">get_request_log_buffer_length</span><span class="sf11b2">() {</span></code></td>
</tr>
<tr>
<td class="ln">232</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">_request_buffer_ix</span><span class="sf11b2">;</span></code></td>
<td class="ln">240</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">_request_buffer_ix</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">233</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
<td class="ln">241</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">234</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">242</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">235</td><td class="sf3b2"><code><span class="sf7b2">protected</span><span class="sf11b2">:</span></code></td>
<td class="ln">243</td><td class="sf3b2"><code><span class="sf7b2">protected</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln">236</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf7b2">virtual</span><span class="sf11b2"> </span><span class="sf3b2">nsapi_error_t</span><span class="sf11b2"> </span><span class="sf8b2">connect_socket</span><span class="sf11b2">(</span><span class="sf7b2">char</span><span class="sf11b2"> *</span><span class="sf3b2">host</span><span class="sf11b2">, </span><span class="sf3b2">uint16_t</span><span class="sf11b2"> </span><span class="sf3b2">port</span><span class="sf11b2">) = </span><span class="sf10b2">0</span><span class="sf11b2">;</span></code></td>
<td class="ln">244</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf7b2">virtual</span><span class="sf11b2"> </span><span class="sf3b2">nsapi_error_t</span><span class="sf11b2"> </span><span class="sf8b2">connect_socket</span><span class="sf11b2">(</span><span class="sf7b2">char</span><span class="sf11b2"> *</span><span class="sf3b2">host</span><span class="sf11b2">, </span><span class="sf3b2">uint16_t</span><span class="sf11b2"> </span><span class="sf3b2">port</span><span class="sf11b2">) = </span><span class="sf10b2">0</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">237</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">245</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">238</td><td class="sf3b2"><code><span class="sf7b2">private</span><span class="sf11b2">:</span></code></td>
<td class="ln">246</td><td class="sf3b2"><code><span class="sf7b2">private</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln">239</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">nsapi_error_t</span><span class="sf11b2"> </span><span class="sf8b2">connect_socket</span><span class="sf11b2">( ) {</span></code></td>
<td class="ln">247</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">nsapi_error_t</span><span class="sf11b2"> </span><span class="sf8b2">connect_socket</span><span class="sf11b2">( ) {</span></code></td>
</tr>
<tr>
<td class="ln">240</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">_response</span><span class="sf11b2"> != </span><span class="sf3b2">NULL</span><span class="sf11b2">) {</span></code></td>
<td class="ln">248</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">_response</span><span class="sf11b2"> != </span><span class="sf3b2">NULL</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">241</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// already executed this response</span></code></td>
<td class="ln">249</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// already executed this response</span></code></td>
</tr>
<tr>
<td class="ln">242</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> -</span><span class="sf10b2">2100</span><span class="sf11b2">; </span><span class="sf9b2">// @todo, make a lookup table with errors</span></code></td>
<td class="ln">250</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> -</span><span class="sf10b2">2100</span><span class="sf11b2">; </span><span class="sf9b2">// @todo, make a lookup table with errors</span></code></td>
</tr>
<tr>
<td class="ln">243</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">251</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">244</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">252</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">245</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">253</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">246</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">_we_created_socket</span><span class="sf11b2">) {</span></code></td>
<td class="ln">254</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">_we_created_socket</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">247</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nsapi_error_t</span><span class="sf11b2"> </span><span class="sf3b2">connection_result</span><span class="sf11b2"> = </span><span class="sf8b2">connect_socket</span><span class="sf11b2">(</span><span class="sf3b2">_parsed_url</span><span class="sf11b2">-&gt;</span><span class="sf8b2">host</span><span class="sf11b2">(), </span><span class="sf3b2">_parsed_url</span><span class="sf11b2">-&gt;</span><span class="sf8b2">port</span><span class="sf11b2">());</span></code></td>
<td class="ln">255</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nsapi_error_t</span><span class="sf11b2"> </span><span class="sf3b2">connection_result</span><span class="sf11b2"> = </span><span class="sf8b2">connect_socket</span><span class="sf11b2">(</span><span class="sf3b2">_parsed_url</span><span class="sf11b2">-&gt;</span><span class="sf8b2">host</span><span class="sf11b2">(), </span><span class="sf3b2">_parsed_url</span><span class="sf11b2">-&gt;</span><span class="sf8b2">port</span><span class="sf11b2">());</span></code></td>
</tr>
<tr>
<td class="ln">248</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">connection_result</span><span class="sf11b2"> != </span><span class="sf3b2">NSAPI_ERROR_OK</span><span class="sf11b2">) {</span></code></td>
<td class="ln">256</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">connection_result</span><span class="sf11b2"> != </span><span class="sf3b2">NSAPI_ERROR_OK</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">249</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">connection_result</span><span class="sf11b2">;</span></code></td>
<td class="ln">257</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">connection_result</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">250</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">258</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">251</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">259</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">252</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">260</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">253</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">NSAPI_ERROR_OK</span><span class="sf11b2">;</span></code></td>
<td class="ln">261</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">NSAPI_ERROR_OK</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">254</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
<td class="ln">262</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">255</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">263</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">256</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">nsapi_size_or_error_t</span><span class="sf11b2"> </span><span class="sf8b2">send_buffer</span><span class="sf11b2">(</span><span class="sf7b2">char</span><span class="sf11b2">* </span><span class="sf3b2">buffer</span><span class="sf11b2">, </span><span class="sf3b2">uint32_t</span><span class="sf11b2"> </span><span class="sf3b2">buffer_size</span><span class="sf11b2">) {</span></code></td>
<td class="ln">264</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">nsapi_size_or_error_t</span><span class="sf11b2"> </span><span class="sf8b2">send_buffer</span><span class="sf11b2">(</span><span class="sf7b2">char</span><span class="sf11b2">* </span><span class="sf3b2">buffer</span><span class="sf11b2">, </span><span class="sf3b2">uint32_t</span><span class="sf11b2"> </span><span class="sf3b2">buffer_size</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">257</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nsapi_size_or_error_t</span><span class="sf11b2"> </span><span class="sf3b2">total_send_count</span><span class="sf11b2"> = </span><span class="sf10b2">0</span><span class="sf11b2">;</span></code></td>
<td class="ln">265</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nsapi_size_or_error_t</span><span class="sf11b2"> </span><span class="sf3b2">total_send_count</span><span class="sf11b2"> = </span><span class="sf10b2">0</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">258</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">while</span><span class="sf11b2"> (</span><span class="sf3b2">total_send_count</span><span class="sf11b2"> &lt; </span><span class="sf3b2">buffer_size</span><span class="sf11b2">) {</span></code></td>
<td class="ln">266</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">while</span><span class="sf11b2"> (</span><span class="sf3b2">total_send_count</span><span class="sf11b2"> &lt; </span><span class="sf3b2">buffer_size</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">259</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">267</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">260</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// get a slice of the buffer</span></code></td>
<td class="ln">268</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// get a slice of the buffer</span></code></td>
</tr>
<tr>
<td class="ln">261</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">char</span><span class="sf11b2"> *</span><span class="sf3b2">buffer_slice</span><span class="sf11b2"> = </span><span class="sf3b2">buffer</span><span class="sf11b2"> + </span><span class="sf3b2">total_send_count</span><span class="sf11b2">;</span></code></td>
<td class="ln">269</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">char</span><span class="sf11b2"> *</span><span class="sf3b2">buffer_slice</span><span class="sf11b2"> = </span><span class="sf3b2">buffer</span><span class="sf11b2"> + </span><span class="sf3b2">total_send_count</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">262</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">uint32_t</span><span class="sf11b2"> </span><span class="sf3b2">buffer_slice_size</span><span class="sf11b2"> = </span><span class="sf3b2">buffer_size</span><span class="sf11b2"> - </span><span class="sf3b2">total_send_count</span><span class="sf11b2">;</span></code></td>
<td class="ln">270</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">uint32_t</span><span class="sf11b2"> </span><span class="sf3b2">buffer_slice_size</span><span class="sf11b2"> = </span><span class="sf3b2">buffer_size</span><span class="sf11b2"> - </span><span class="sf3b2">total_send_count</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">263</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">271</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">264</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// if request buffer was set, copy it there</span></code></td>
<td class="ln">272</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// if request buffer was set, copy it there</span></code></td>
</tr>
<tr>
<td class="ln">265</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">_request_buffer</span><span class="sf11b2"> != </span><span class="sf3b2">NULL</span><span class="sf11b2"> &amp;&amp; </span><span class="sf3b2">_request_buffer_ix</span><span class="sf11b2"> + </span><span class="sf3b2">buffer_slice_size</span><span class="sf11b2"> &lt; </span><span class="sf3b2">_request_buffer_size</span><span class="sf11b2">) {</span></code></td>
<td class="ln">273</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">_request_buffer</span><span class="sf11b2"> != </span><span class="sf3b2">NULL</span><span class="sf11b2"> &amp;&amp; </span><span class="sf3b2">_request_buffer_ix</span><span class="sf11b2"> + </span><span class="sf3b2">buffer_slice_size</span><span class="sf11b2"> &lt; </span><span class="sf3b2">_request_buffer_size</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">266</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf8b2">memcpy</span><span class="sf11b2">(</span><span class="sf3b2">_request_buffer</span><span class="sf11b2"> + </span><span class="sf3b2">_request_buffer_ix</span><span class="sf11b2">, </span><span class="sf3b2">buffer_slice</span><span class="sf11b2">, </span><span class="sf3b2">buffer_slice_size</span><span class="sf11b2">);</span></code></td>
<td class="ln">274</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf8b2">memcpy</span><span class="sf11b2">(</span><span class="sf3b2">_request_buffer</span><span class="sf11b2"> + </span><span class="sf3b2">_request_buffer_ix</span><span class="sf11b2">, </span><span class="sf3b2">buffer_slice</span><span class="sf11b2">, </span><span class="sf3b2">buffer_slice_size</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">267</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_request_buffer_ix</span><span class="sf11b2"> += </span><span class="sf3b2">buffer_slice_size</span><span class="sf11b2">;</span></code></td>
<td class="ln">275</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_request_buffer_ix</span><span class="sf11b2"> += </span><span class="sf3b2">buffer_slice_size</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">268</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">276</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">269</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">277</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">270</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nsapi_size_or_error_t</span><span class="sf11b2"> </span><span class="sf3b2">send_result</span><span class="sf11b2"> = </span><span class="sf3b2">_socket</span><span class="sf11b2">-&gt;</span><span class="sf8b2">send</span><span class="sf11b2">(</span><span class="sf3b2">buffer_slice</span><span class="sf11b2">, </span><span class="sf3b2">buffer_slice_size</span><span class="sf11b2">);</span></code></td>
<td class="ln">278</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nsapi_size_or_error_t</span><span class="sf11b2"> </span><span class="sf3b2">send_result</span><span class="sf11b2"> = </span><span class="sf3b2">_socket</span><span class="sf11b2">-&gt;</span><span class="sf8b2">send</span><span class="sf11b2">(</span><span class="sf3b2">buffer_slice</span><span class="sf11b2">, </span><span class="sf3b2">buffer_slice_size</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">271</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">279</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">272</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">send_result</span><span class="sf11b2"> &lt; </span><span class="sf10b2">0</span><span class="sf11b2">) {</span></code></td>
<td class="ln">280</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">send_result</span><span class="sf11b2"> &lt; </span><span class="sf10b2">0</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">273</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">total_send_count</span><span class="sf11b2"> = </span><span class="sf3b2">send_result</span><span class="sf11b2">;</span></code></td>
<td class="ln">281</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">total_send_count</span><span class="sf11b2"> = </span><span class="sf3b2">send_result</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">274</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">break</span><span class="sf11b2">;</span></code></td>
<td class="ln">282</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">break</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">275</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">283</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">276</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">284</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">277</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">send_result</span><span class="sf11b2"> == </span><span class="sf10b2">0</span><span class="sf11b2">) {</span></code></td>
<td class="ln">285</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">send_result</span><span class="sf11b2"> == </span><span class="sf10b2">0</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">278</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">break</span><span class="sf11b2">;</span></code></td>
<td class="ln">286</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">break</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">279</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">287</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">280</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">288</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">281</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">total_send_count</span><span class="sf11b2"> += </span><span class="sf3b2">send_result</span><span class="sf11b2">;</span></code></td>
<td class="ln">289</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">total_send_count</span><span class="sf11b2"> += </span><span class="sf3b2">send_result</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">282</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">290</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">283</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">291</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">284</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">total_send_count</span><span class="sf11b2">;</span></code></td>
<td class="ln">292</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">total_send_count</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">285</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
<td class="ln">293</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">286</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">294</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">287</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">HttpResponse</span><span class="sf11b2">* </span><span class="sf8b2">create_http_response</span><span class="sf11b2">() {</span></code></td>
<td class="ln">295</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">HttpResponse</span><span class="sf11b2">* </span><span class="sf8b2">create_http_response</span><span class="sf11b2">() {</span></code></td>
</tr>
<tr>
<td class="ln">288</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// Create a response object</span></code></td>
<td class="ln">296</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// Create a response object</span></code></td>
</tr>
<tr>
<td class="ln">289</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_response</span><span class="sf11b2"> = </span><span class="sf7b2">new</span><span class="sf11b2"> </span><span class="sf8b2">HttpResponse</span><span class="sf11b2">();</span></code></td>
<td class="ln">297</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_response</span><span class="sf11b2"> = </span><span class="sf7b2">new</span><span class="sf11b2"> </span><span class="sf8b2">HttpResponse</span><span class="sf11b2">();</span></code></td>
</tr>
<tr>
<td class="ln">290</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// And a response parser</span></code></td>
<td class="ln">298</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// And a response parser</span></code></td>
</tr>
<tr>
<td class="ln">291</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">HttpParser</span><span class="sf11b2"> </span><span class="sf8b2">parser</span><span class="sf11b2">(</span><span class="sf3b2">_response</span><span class="sf11b2">, </span><span class="sf3b2">HTTP_RESPONSE</span><span class="sf11b2">, </span><span class="sf3b2">_body_callback</span><span class="sf11b2">);</span></code></td>
<td class="ln">299</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">HttpParser</span><span class="sf11b2"> </span><span class="sf8b2">parser</span><span class="sf11b2">(</span><span class="sf3b2">_response</span><span class="sf11b2">, </span><span class="sf3b2">HTTP_RESPONSE</span><span class="sf11b2">, </span><span class="sf3b2">_body_callback</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">292</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">300</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">293</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// Set up a receive buffer (on the heap)</span></code></td>
<td class="ln">301</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// Set up a receive buffer (on the heap)</span></code></td>
</tr>
<tr>
<td class="ln">294</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">uint8_t</span><span class="sf11b2">* </span><span class="sf3b2">recv_buffer</span><span class="sf11b2"> = (</span><span class="sf3b2">uint8_t</span><span class="sf11b2">*)</span><span class="sf8b2">malloc</span><span class="sf11b2">(</span><span class="sf3b2">HTTP_RECEIVE_BUFFER_SI<wbr>ZE</span><span class="sf11b2">);</span></code></td>
<td class="ln">302</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">uint8_t</span><span class="sf11b2">* </span><span class="sf3b2">recv_buffer</span><span class="sf11b2"> = (</span><span class="sf3b2">uint8_t</span><span class="sf11b2">*)</span><span class="sf8b2">malloc</span><span class="sf11b2">(</span><span class="sf3b2">HTTP_RECEIVE_BUFFER_SI<wbr>ZE</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">295</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">303</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">296</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// Socket::recv is called until we don't have any data anymore</span></code></td>
<td class="ln">304</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// Socket::recv is called until we don't have any data anymore</span></code></td>
</tr>
<tr>
<td class="ln">297</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nsapi_size_or_error_t</span><span class="sf11b2"> </span><span class="sf3b2">recv_ret</span><span class="sf11b2">;</span></code></td>
<td class="ln">305</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nsapi_size_or_error_t</span><span class="sf11b2"> </span><span class="sf3b2">recv_ret</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">298</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">while</span><span class="sf11b2"> ((</span><span class="sf3b2">recv_ret</span><span class="sf11b2"> = </span><span class="sf3b2">_socket</span><span class="sf11b2">-&gt;</span><span class="sf8b2">recv</span><span class="sf11b2">(</span><span class="sf3b2">recv_buffer</span><span class="sf11b2">, </span><span class="sf3b2">HTTP_RECEIVE_BUFFER_SIZE</span><span class="sf11b2">)) &gt; </span><span class="sf10b2">0</span><span class="sf11b2">) {</span></code></td>
<td class="ln">306</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">while</span><span class="sf11b2"> ((</span><span class="sf3b2">recv_ret</span><span class="sf11b2"> = </span><span class="sf3b2">_socket</span><span class="sf11b2">-&gt;</span><span class="sf8b2">recv</span><span class="sf11b2">(</span><span class="sf3b2">recv_buffer</span><span class="sf11b2">, </span><span class="sf3b2">HTTP_RECEIVE_BUFFER_SIZE</span><span class="sf11b2">)) &gt; </span><span class="sf10b2">0</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">299</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">307</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">300</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// Pass the chunk into the http_parser</span></code></td>
<td class="ln">308</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// Pass the chunk into the http_parser</span></code></td>
</tr>
<tr>
<td class="ln">301</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">uint32_t</span><span class="sf11b2"> </span><span class="sf3b2">nparsed</span><span class="sf11b2"> = </span><span class="sf3b2">parser</span><span class="sf11b2">.</span><span class="sf8b2">execute</span><span class="sf11b2">((</span><span class="sf7b2">const</span><span class="sf11b2"> </span><span class="sf7b2">char</span><span class="sf11b2">*)</span><span class="sf3b2">recv_buffer</span><span class="sf11b2">, </span><span class="sf3b2">recv_ret</span><span class="sf11b2">);</span></code></td>
<td class="ln">309</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">uint32_t</span><span class="sf11b2"> </span><span class="sf3b2">nparsed</span><span class="sf11b2"> = </span><span class="sf3b2">parser</span><span class="sf11b2">.</span><span class="sf8b2">execute</span><span class="sf11b2">((</span><span class="sf7b2">const</span><span class="sf11b2"> </span><span class="sf7b2">char</span><span class="sf11b2">*)</span><span class="sf3b2">recv_buffer</span><span class="sf11b2">, </span><span class="sf3b2">recv_ret</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">302</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">nparsed</span><span class="sf11b2"> != </span><span class="sf3b2">recv_ret</span><span class="sf11b2">) {</span></code></td>
<td class="ln">310</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">nparsed</span><span class="sf11b2"> != </span><span class="sf3b2">recv_ret</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">303</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// printf("Parsing failed... parsed %d bytes, received %d bytes\n", nparsed, recv_ret);</span></code></td>
<td class="ln">311</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// printf("Parsing failed... parsed %d bytes, received %d bytes\n", nparsed, recv_ret);</span></code></td>
</tr>
<tr>
<td class="ln">304</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_error</span><span class="sf11b2"> = -</span><span class="sf10b2">2101</span><span class="sf11b2">;</span></code></td>
<td class="ln">312</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_error</span><span class="sf11b2"> = -</span><span class="sf10b2">2101</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">305</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf8b2">free</span><span class="sf11b2">(</span><span class="sf3b2">recv_buffer</span><span class="sf11b2">);</span></code></td>
<td class="ln">313</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf8b2">free</span><span class="sf11b2">(</span><span class="sf3b2">recv_buffer</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">306</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">NULL</span><span class="sf11b2">;</span></code></td>
<td class="ln">314</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">NULL</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">307</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">315</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">308</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">316</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">309</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">_response</span><span class="sf11b2">-&gt;</span><span class="sf8b2">is_message_complete</span><span class="sf11b2">()) {</span></code></td>
<td class="ln">317</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">_response</span><span class="sf11b2">-&gt;</span><span class="sf8b2">is_message_complete</span><span class="sf11b2">()) {</span></code></td>
</tr>
<tr>
<td class="ln">310</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">break</span><span class="sf11b2">;</span></code></td>
<td class="ln">318</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">break</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">311</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">319</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">312</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">320</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">313</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// error?</span></code></td>
<td class="ln">321</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// error?</span></code></td>
</tr>
<tr>
<td class="ln">314</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">recv_ret</span><span class="sf11b2"> &lt; </span><span class="sf10b2">0</span><span class="sf11b2">) {</span></code></td>
<td class="ln">322</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">recv_ret</span><span class="sf11b2"> &lt; </span><span class="sf10b2">0</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">315</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_error</span><span class="sf11b2"> = </span><span class="sf3b2">recv_ret</span><span class="sf11b2">;</span></code></td>
<td class="ln">323</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_error</span><span class="sf11b2"> = </span><span class="sf3b2">recv_ret</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">316</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf8b2">free</span><span class="sf11b2">(</span><span class="sf3b2">recv_buffer</span><span class="sf11b2">);</span></code></td>
<td class="ln">324</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf8b2">free</span><span class="sf11b2">(</span><span class="sf3b2">recv_buffer</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">317</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">NULL</span><span class="sf11b2">;</span></code></td>
<td class="ln">325</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">NULL</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">318</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">326</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">319</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">327</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">320</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// When done, call parser.finish()</span></code></td>
<td class="ln">328</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// When done, call parser.finish()</span></code></td>
</tr>
<tr>
<td class="ln">321</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">parser</span><span class="sf11b2">.</span><span class="sf8b2">finish</span><span class="sf11b2">();</span></code></td>
<td class="ln">329</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">parser</span><span class="sf11b2">.</span><span class="sf8b2">finish</span><span class="sf11b2">();</span></code></td>
</tr>
<tr>
<td class="ln">322</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">330</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">323</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// Free the receive buffer</span></code></td>
<td class="ln">331</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// Free the receive buffer</span></code></td>
</tr>
<tr>
<td class="ln">324</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf8b2">free</span><span class="sf11b2">(</span><span class="sf3b2">recv_buffer</span><span class="sf11b2">);</span></code></td>
<td class="ln">332</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf8b2">free</span><span class="sf11b2">(</span><span class="sf3b2">recv_buffer</span><span class="sf11b2">);</span></code></td>
</tr>
<tr>
<td class="ln">325</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">333</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">326</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">_we_created_socket</span><span class="sf11b2">) {</span></code></td>
<td class="ln">334</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">if</span><span class="sf11b2"> (</span><span class="sf3b2">_we_created_socket</span><span class="sf11b2">) {</span></code></td>
</tr>
<tr>
<td class="ln">327</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// Close the socket</span></code></td>
<td class="ln">335</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf9b2">// Close the socket</span></code></td>
</tr>
<tr>
<td class="ln">328</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_socket</span><span class="sf11b2">-&gt;</span><span class="sf8b2">close</span><span class="sf11b2">();</span></code></td>
<td class="ln">336</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">_socket</span><span class="sf11b2">-&gt;</span><span class="sf8b2">close</span><span class="sf11b2">();</span></code></td>
</tr>
<tr>
<td class="ln">329</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
<td class="ln">337</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">330</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">338</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">331</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">_response</span><span class="sf11b2">;</span></code></td>
<td class="ln">339</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf7b2">return</span><span class="sf11b2"> </span><span class="sf3b2">_response</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">332</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
<td class="ln">340</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;}</span></code></td>
</tr>
<tr>
<td class="ln">333</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">341</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">334</td><td class="sf3b2"><code><span class="sf7b2">private</span><span class="sf11b2">:</span></code></td>
<td class="ln">342</td><td class="sf3b2"><code><span class="sf7b2">private</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln">335</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">Socket</span><span class="sf11b2">* </span><span class="sf3b2">_socket</span><span class="sf11b2">;</span></code></td>
<td class="ln">343</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">Socket</span><span class="sf11b2">* </span><span class="sf3b2">_socket</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">336</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">Callback</span><span class="sf11b2">&lt;</span><span class="sf7b2">void</span><span class="sf11b2">(</span><span class="sf7b2">const</span><span class="sf11b2"> </span><span class="sf7b2">char</span><span class="sf11b2"> *</span><span class="sf3b2">at</span><span class="sf11b2">, </span><span class="sf3b2">uint32_t</span><span class="sf11b2"> </span><span class="sf3b2">length</span><span class="sf11b2">)&gt; </span><span class="sf3b2">_body_callback</span><span class="sf11b2">;</span></code></td>
<td class="ln">344</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">Callback</span><span class="sf11b2">&lt;</span><span class="sf7b2">void</span><span class="sf11b2">(</span><span class="sf7b2">const</span><span class="sf11b2"> </span><span class="sf7b2">char</span><span class="sf11b2"> *</span><span class="sf3b2">at</span><span class="sf11b2">, </span><span class="sf3b2">uint32_t</span><span class="sf11b2"> </span><span class="sf3b2">length</span><span class="sf11b2">)&gt; </span><span class="sf3b2">_body_callback</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">337</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">345</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">338</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">ParsedUrl</span><span class="sf11b2">* </span><span class="sf3b2">_parsed_url</span><span class="sf11b2">;</span></code></td>
<td class="ln">346</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">ParsedUrl</span><span class="sf11b2">* </span><span class="sf3b2">_parsed_url</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">339</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">347</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">340</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">HttpRequestBuilder</span><span class="sf11b2">* </span><span class="sf3b2">_request_builder</span><span class="sf11b2">;</span></code></td>
<td class="ln">348</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">HttpRequestBuilder</span><span class="sf11b2">* </span><span class="sf3b2">_request_builder</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">341</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">HttpResponse</span><span class="sf11b2">* </span><span class="sf3b2">_response</span><span class="sf11b2">;</span></code></td>
<td class="ln">349</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">HttpResponse</span><span class="sf11b2">* </span><span class="sf3b2">_response</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">342</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">350</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">343</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf7b2">bool</span><span class="sf11b2"> </span><span class="sf3b2">_we_created_socket</span><span class="sf11b2">;</span></code></td>
<td class="ln">351</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf7b2">bool</span><span class="sf11b2"> </span><span class="sf3b2">_we_created_socket</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">344</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">352</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">345</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">nsapi_error_t</span><span class="sf11b2"> </span><span class="sf3b2">_error</span><span class="sf11b2">;</span></code></td>
<td class="ln">353</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">nsapi_error_t</span><span class="sf11b2"> </span><span class="sf3b2">_error</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">346</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">354</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">347</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">uint8_t</span><span class="sf11b2"> *</span><span class="sf3b2">_request_buffer</span><span class="sf11b2">;</span></code></td>
<td class="ln">355</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">uint8_t</span><span class="sf11b2"> *</span><span class="sf3b2">_request_buffer</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">348</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">size_t</span><span class="sf11b2"> </span><span class="sf3b2">_request_buffer_size</span><span class="sf11b2">;</span></code></td>
<td class="ln">356</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">size_t</span><span class="sf11b2"> </span><span class="sf3b2">_request_buffer_size</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">349</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">size_t</span><span class="sf11b2"> </span><span class="sf3b2">_request_buffer_ix</span><span class="sf11b2">;</span></code></td>
<td class="ln">357</td><td class="sf3b2"><code><span class="sf11b2"> &nbsp; &nbsp;</span><span class="sf3b2">size_t</span><span class="sf11b2"> </span><span class="sf3b2">_request_buffer_ix</span><span class="sf11b2">;</span></code></td>
</tr>
<tr>
<td class="ln">350</td><td class="sf3b2"><code><span class="sf11b2">};</span></code></td>
<td class="ln">358</td><td class="sf3b2"><code><span class="sf11b2">};</span></code></td>
</tr>
<tr>
<td class="ln">351</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">359</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln">352</td><td class="sf3b2"><code><span class="sf13b2">#endif </span><span class="sf9b2">// _HTTP_REQUEST_BASE_H_</span></code></td>
<td class="ln">360</td><td class="sf3b2"><code><span class="sf13b2">#endif </span><span class="sf9b2">// _HTTP_REQUEST_BASE_H_</span></code></td>
</tr>
<tr>
<td class="ln">353</td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln">361</td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
</tbody>
</table>
</body>
</html>
